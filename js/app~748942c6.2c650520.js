!function(e){function t(t){for(var n,s,u=t[0],o=t[1],c=t[2],l=0,f=[];l<u.length;l++)s=u[l],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(p&&p(t);f.length;)f.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,u=1;u<r.length;u++){var o=r[u];0!==a[o]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={"app~748942c6":0},i=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/sign_web3/";var u=window.webpackJsonp=window.webpackJsonp||[],o=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var p=o;i.push([0,"vendors~app~c913e6bf","vendors~app~f5fb4fe9","vendors~app~edb28f9c","vendors~app~c703ebae","vendors~app~92dba14a","vendors~app~1a738be0","vendors~app~2627d776"]),r()}({0:function(e,t,r){e.exports=r("56d7")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("6da3"),r("dea3"),r("da68"),r("1311");var n=r("430a"),a=r("0d9f"),i=r("a8d5"),s=r("f026"),u=(r("e186"),r("7926"),r("865d"),r("89a8"),r("d5ee"),r("cfe5"),r("7736")),o=r("f962"),c=r.n(o),p=r("2772"),l=r("efce"),f=r("e8d3"),d=(r("cb0a"),r("8fec"),r("87d5"),r("84ec")),h=r("fa24"),v=r.n(h),g=r("69f1"),m=r.n(g),b={state:{account:{}},mutations:{SET_ACCOUNT:function(e,t){e.account=t}},actions:{setAccount:function(e,t){(0,e.commit)("SET_ACCOUNT",t)}}},w={app:function(e){return e.app}};n.default.use(u.a);var y=new u.a.Store({modules:{app:b},getters:w}),k=new(function(){function e(){Object(l.a)(this,e),this.ethers=d.a,this.utils=d.a.utils,this.web3Modal=null,this.provider=null,this.signer=null,this.web3=null,this.shh=null,this.BigNumber=d.a.BigNumber,this.connected=!1,this.try=3,this.delay=2e3}var t,r,n,s,u,o,c,h,g,b,w,k,x,R,j,O,C,W,D,_,T,S,P,A,B,N,M;return Object(f.a)(e,[{key:"sleep",value:function(e){return new Promise((function(t,r){return setTimeout(t,e)}))}},{key:"check",value:function(){return!!this.connected}},{key:"awaitWrap",value:(M=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.then((function(e){return[null,e]})).catch((function(e){return e instanceof Error?(console.log(e),[e.message,null]):(console.log(e),"object"==Object(p.a)(e)?[JSON.stringify(e),null]:[e,null])})));case 1:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"init",value:(N=Object(i.a)(regeneratorRuntime.mark((function e(){var t,r,n,i,s,u,o,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},r=new m.a({cacheProvider:!0,providerOptions:t}),this.web3Modal=r,n=null,i=null,s=!1,u=0;case 6:if(!(u<10)){e.next=26;break}return e.next=9,this.awaitWrap(r.connect());case 9:if(o=e.sent,c=Object(a.a)(o,2),n=c[0],!(i=c[1])){e.next=20;break}return s=!0,this.connected=!0,console.log("connect pass"),e.abrupt("break",26);case 20:console.log("connect fail");case 21:return e.next=23,this.sleep(1e3);case 23:u++,e.next=6;break;case 26:if(s){e.next=29;break}return console.log("connect fail, over max try time"),e.abrupt("return",["connect fail, over max try time",null]);case 29:return this.web3=new v.a(i),this.provider=new d.a.providers.Web3Provider(i),this.signer=this.provider.getSigner(),e.next=34,this.signer.getAddress();case 34:return e.t0=e.sent,p={address:e.t0},y.dispatch("setAccount",p),e.abrupt("return",[n,i]);case 38:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"transact",value:(B=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.check()){e.next=2;break}return e.abrupt("return",["no connect",null]);case 2:return e.abrupt("return",this.awaitWrap(this.signer.sendTransaction(t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return B.apply(this,arguments)})},{key:"transactAndWait",value:(A=Object(i.a)(regeneratorRuntime.mark((function e(t){var r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.check()){e.next=2;break}return e.abrupt("return",["no connect",null]);case 2:return e.next=4,this.awaitWrap(this.signer.sendTransaction(t));case 4:if(r=e.sent,n=Object(a.a)(r,2),i=n[0],s=n[1],!i){e.next=10;break}return e.abrupt("return",[i,s]);case 10:return e.abrupt("return",this.waitForTransaction(s.hash));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"signMessage",value:(P=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.check()){e.next=2;break}return e.abrupt("return",["no connect",null]);case 2:return e.abrupt("return",this.awaitWrap(this.signer.signMessage(t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"isSigner",value:(S=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.signer.isSigner(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"getNetwork",value:(T=Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getNetwork()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"getBalance",value:(_=Object(i.a)(regeneratorRuntime.mark((function e(t){var r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,n=null,e.next=3,this.awaitWrap(this.provider.getBalance(t));case 3:if(i=e.sent,s=Object(a.a)(i,2),r=s[0],!(n=s[1])){e.next=9;break}return e.abrupt("return",[r,this.ethers.utils.formatEther(n)]);case 9:return e.abrupt("return",[r,n]);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"getTransactionCount",value:(D=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getTransactionCount(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"getBlockNumber",value:(W=Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getBlockNumber()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return W.apply(this,arguments)})},{key:"getGasPrice",value:(C=Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getGasPrice()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"getFeeData",value:(O=Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getFeeData()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"getBlock",value:(j=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getBlock(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"getBlockWithTransactions",value:(R=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getBlockWithTransactions(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"getTransaction",value:(x=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getTransaction(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"getTransactionReceipt",value:(k=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getTransactionReceipt(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"resolveName",value:(w=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.resolveName(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"lookupAddress",value:(b=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.lookupAddress(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"call",value:(g=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.call(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"estimateGas",value:(h=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.estimateGas(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getCode",value:(c=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getCode(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getStorageAt",value:(o=Object(i.a)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getStorageAt(t,r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"getLogs",value:(u=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.getLogs(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"on",value:(s=Object(i.a)(regeneratorRuntime.mark((function e(t){var r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e,r){n.provider.on(t,(function(t){e(t)}))})),e.abrupt("return",this.awaitWrap(r));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"once",value:(n=Object(i.a)(regeneratorRuntime.mark((function e(t){var r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e,r){n.provider.once(t,(function(t){e(t)}))})),e.abrupt("return",this.awaitWrap(r));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"removeListener",value:(r=Object(i.a)(regeneratorRuntime.mark((function e(t){var r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e,r){n.provider.removeListener(t,(function(t){e(t)}))})),e.abrupt("return",this.awaitWrap(r));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"removeAllListeners",value:function(e){return this.provider.removeAllListeners(e)}},{key:"listenerCount",value:function(e){return this.provider.listenerCount(e)}},{key:"resetEventsBlock",value:function(e){return this.provider.resetEventsBlock(e)}},{key:"waitForTransaction",value:(t=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.awaitWrap(this.provider.waitForTransaction(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"Contract",value:function(e,t,r){return r&&"provider"==r?new this.ethers.Contract(e,t,this.provider):new this.ethers.Contract(e,t,this.signer)}},{key:"ERC20Contract",value:function(e,t){var r=["function balanceOf(address owner) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)","function transfer(address to, uint amount) returns (bool)","event Transfer(address indexed from, address indexed to, uint amount)"];return t&&"provider"==t?new this.ethers.Contract(e,r,this.provider):new this.ethers.Contract(e,r,this.signer)}}]),e}()),x={name:"sign_web3",components:{},data:function(){return{logined:!1,rawData1:"",rawData2:"",signData1:"",signData2:"",address:"",loading:!1}},computed:Object(s.a)({},Object(u.b)({account:function(e){return e.app.account}})),methods:{handleLogin:function(){var e=this;return Object(i.a)(regeneratorRuntime.mark((function t(){var r,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.init();case 2:r=t.sent,n=Object(a.a)(r,2),i=n[0],n[1],i?e.$toast({type:"fail",message:i.toString()}):e.logined=!0;case 7:case"end":return t.stop()}}),t)})))()},handleCopy:function(){var e=this,t=new c.a(".copy");t.on("success",(function(r){e.$toast({type:"success",message:"复制完成"}),t.destroy()})),t.on("error",(function(r){e.$toast({type:"success",message:"复制完成"}),t.destroy()}))},handleSign:function(){var e=this;return Object(i.a)(regeneratorRuntime.mark((function t(){var r,n,i,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=e.rawData1.trim()){t.next=3;break}return e.$toast({type:"fail",message:"原始信息不能为空"}),t.abrupt("return");case 3:return t.next=5,k.signMessage(e.rawData1.trim());case 5:if(r=t.sent,n=Object(a.a)(r,2),i=n[0],s=n[1],!i){t.next=12;break}return e.$toast({type:"fail",message:i.toString()}),t.abrupt("return");case 12:e.signData1=s;case 13:case"end":return t.stop()}}),t)})))()},handleVerifySign:function(){var e=this;return Object(i.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading=!0,""!=e.rawData2.trim()){t.next=5;break}return e.$toast({type:"fail",message:"原始信息不能为空"}),e.loading=!1,t.abrupt("return");case 5:if(""!=e.signData2.trim()){t.next=9;break}return e.$toast({type:"fail",message:"签名信息不能为空"}),e.loading=!1,t.abrupt("return");case 9:r="",t.prev=10,r=k.ethers.utils.verifyMessage(e.rawData2.trim(),e.signData2.trim()),t.next=19;break;case 14:return t.prev=14,t.t0=t.catch(10),e.$toast({type:"fail",message:"签名信息异常"}),e.loading=!1,t.abrupt("return");case 19:e.address=r,e.loading=!1;case 21:case"end":return t.stop()}}),t,null,[[10,14]])})))()},handleCheckInput:function(){this.signData2=this.signData2.trim()}},mounted:function(){this.handleLogin()}},R=(r("5c0b"),r("cba8")),j=Object(R.a)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main rpx-2"},[r("el-card",[r("div",{staticClass:"d-flex justify-content-between align-items-center"},[e.logined?r("div",[e._v("地址："),r("span",{staticClass:"fs-small"},[e._v(e._s(e.account.address))])]):r("van-loading",{attrs:{type:"spinner",color:"#1989fa",size:"20px"}},[e._v("连接中...")])],1)]),r("el-card",{staticClass:"rmt-2 rmb-2 fs-base"},[r("div",{staticClass:"fs-medium hardline"},[e._v("签名")]),r("el-divider"),r("div",{staticClass:"d-flex justify-content-start rmb-3"},[r("div",{staticClass:"d-flex align-items-center w-70 flex-none"},[e._v("原始信息")]),r("div",{staticClass:"flex-grow-1"},[r("el-input",{attrs:{autosize:"",placeholder:"输入待签名的信息"},model:{value:e.rawData1,callback:function(t){e.rawData1=t},expression:"rawData1"}})],1)]),r("div",{staticClass:"d-flex justify-content-start rmb-3"},[r("div",{staticClass:"d-flex align-items-center w-70 flex-none"},[e._v("签名信息")]),r("div",{staticClass:"flex-grow-1"},[r("el-input",{staticClass:"content1",attrs:{type:"textarea",autosize:"",disabled:"",placeholder:"通过签名生成的信息"},model:{value:e.signData1,callback:function(t){e.signData1=t},expression:"signData1"}})],1)]),r("div",{staticClass:"d-flex justify-content-end"},[r("el-button",{staticClass:"copy",attrs:{"data-clipboard-action":"copy","data-clipboard-target":".content1",type:"primary",size:"medium",plain:""},on:{click:e.handleCopy}},[e._v("复制")]),r("el-button",{attrs:{type:"primary",size:"medium",plain:""},on:{click:e.handleSign}},[e._v("签名")])],1)],1),r("el-card",{staticClass:"rmt-2 rmb-2 fs-base"},[r("div",{staticClass:"fs-medium hardline"},[e._v("验签")]),r("el-divider"),r("div",{staticClass:"d-flex justify-content-start rmb-3"},[r("div",{staticClass:"d-flex align-items-center w-70 flex-none"},[e._v("原始信息")]),r("div",{staticClass:"flex-grow-1"},[r("el-input",{attrs:{autosize:"",placeholder:"输入签名的原始信息"},model:{value:e.rawData2,callback:function(t){e.rawData2=t},expression:"rawData2"}})],1)]),r("div",{staticClass:"d-flex justify-content-start rmb-3"},[r("div",{staticClass:"d-flex align-items-center w-70 flex-none"},[e._v("签名信息")]),r("div",{staticClass:"flex-grow-1"},[r("el-input",{staticClass:"content2",attrs:{type:"textarea",autosize:"",placeholder:"输入签名信息"},on:{input:e.handleCheckInput},model:{value:e.signData2,callback:function(t){e.signData2=t},expression:"signData2"}})],1)]),r("div",{staticClass:"d-flex justify-content-end rmb-3"},[r("el-button",{attrs:{type:"primary",size:"medium",loading:e.loading,plain:""},on:{click:e.handleVerifySign}},[e._v("验签")])],1),r("div",{staticClass:"d-flex justify-content-start rmb-3"},[r("div",{staticClass:"d-flex align-items-center w-70 flex-none"},[e._v("地址信息")]),r("div",{staticClass:"flex-grow-1"},[r("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"通过验签获取"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1)])],1)],1)}),[],!1,null,null,null).exports,O=r("b1eb");r("a7eb");n.default.use(O.a);var C=r("5422"),W=r.n(C);r("e9b7");n.default.use(W.a);r("c35d");n.default.config.productionTip=!1,new n.default({store:y,render:function(e){return e(j)}}).$mount("#app")},"5c0b":function(e,t,r){"use strict";r("7df9")},6:function(e,t){},7:function(e,t){},"7df9":function(e,t,r){},c35d:function(e,t,r){}});